# Gemini 작업 기록 및 분석 내용

이 문서는 Gemini가 프로젝트를 분석하고 디버깅한 내용을 요약한 기록입니다. 다른 도구나 세션에서 이 프로젝트의 맥락을 빠르게 파악하는 데 사용될 수 있습니다.

## 1. 프로젝트 개요

- **프로젝트명:** 태그 기반 근무유형 분석 시스템
- **핵심 목표:** 직원들의 태그 로그 데이터를 분석하여 '실제 업무시간'을 산출하고, 활동 유형(업무, 휴게, 식사, 이동 등)을 분류합니다.
- **주요 로직:**
    - 초기에는 HMM(Hidden Markov Model) 사용이 고려되었으나, 현재는 **규칙 기반 시스템(Rule-Based System)**으로 구현되어 있습니다.
    - 모든 상태 판정 로직은 `태그 기반 근무유형 분석 시스템 - 참조 문서.md` 파일에 정의된 규칙을 따릅니다.

## 2. 디버깅 과정 요약 (2025-07-27)

### 문제 현상
- 사용자가 제공한 스크린샷에서 '실제 업무시간'이 1.5시간으로 매우 낮게 측정되는 문제가 확인되었습니다. (총 체류시간 11.47시간)
- 이로 인해 '업무 효율성'이 14.3%로 비정상적으로 낮게 표시되었습니다.

### 원인 분석
1.  **초기 가설 (O-Tag 누락):** 장비 사용 로그에서 생성되는 'O-Tag'(확정 업무) 데이터가 누락되었을 것이라 예상했으나, 확인 결과 해당 날짜에 4,000개 이상의 O-Tag가 정상적으로 생성되어 있었습니다.
2.  **핵심 원인 발견:** 문제는 순수 태깅 데이터 처리 로직에 있었습니다.
    - `src/tag_system/state_classifier.py`의 `_adjust_probability_by_duration` 함수를 분석한 결과, '경유', '휴게', '식사' 상태는 지속 시간에 따라 확률이 조정되는 로직이 있었지만, **'업무(WORK)' 상태에 대한 조정 로직이 완전히 누락**되어 있었습니다.
    - 이 때문에, 직원이 'G1'(주업무 공간) 태그 위치에 몇 시간을 머물러도 '업무'로 판정될 확률이 올라가지 않아, 해당 시간이 업무 시간으로 집계되지 않았습니다.

### 해결 조치
- `src/tag_system/state_classifier.py` 파일의 `_adjust_probability_by_duration` 함수를 수정했습니다.
- '업무(WORK)' 상태일 때, 지속 시간이 30분 이상이면 '업무'일 확률을 높이는 규칙(참조 문서 기반)을 추가하여, `G1` 공간에서의 장기 체류가 실제 업무시간으로 올바르게 집계되도록 조치했습니다.
